{"version":3,"file":"bundle.js","sources":["../src/store.ts","../src/dispatcher.ts","../src/actioncreator.ts","../src/createstore.ts","../src/index.ts"],"sourcesContent":["import {IAction, IHandler, IMiddlewear, IReducer, IStore} from '../types/index.d'\n\nexport default class Store<TState> implements IStore {\n    private _state: TState\n    private _reducer: IReducer\n\n    constructor(reducer, initialState: TState) {\n        this.reducer = reducer\n        this.state = initialState\n    }\n\n    set state(state: TState) {\n        this._state = state\n    }\n\n    get state(): TState {\n        return this._state\n    }\n\n    set reducer(reducer: IReducer) {\n        if (!reducer) {\n            throw Error(`Reducer is nessesary.`)\n        }\n        this._reducer = reducer\n    }\n\n    get reducer(): IReducer {\n        return this._reducer\n    }\n\n    public reduce(action: IAction, handler?: IHandler, middlewear?: IMiddlewear): TState {\n        if (!this._reducer) {\n            throw Error(`store should has reducer`)\n        }\n\n        let state = this.state\n\n        if (middlewear) {\n            middlewear.call(null, state, action)\n        }\n\n        state = this.reducer.call(null, state, action)\n\n        if (handler) {\n            handler.call(null, state)\n        }\n\n        this.state = state\n        return state\n    }\n}\n","import {IAction, IHandler, IMiddlewear, IStore, IDispatcher, IBindDispatcherToStore} from '../types/index.d'\n\nexport default class Dispatcher implements IDispatcher {\n    private _stores: any[] = []\n\n    public register(store: IStore): IBindDispatcherToStore {\n        if (!store) {\n            throw new Error(`Should provide store.`)\n        }\n        const handlers: IHandler[] = []\n        const middlewears: IMiddlewear[] = []\n\n        const handler = (data) => {\n            if (handlers.length <= 0) {\n                return\n            }\n\n            handlers.map(handler => {\n                handler.call(this, data)\n            })\n        }\n\n        const middlewear = (data, action) => {\n            if (middlewears.length <= 0) {\n                return\n            }\n            middlewears.map(enhancer => {\n                enhancer.call(this, data, action)\n            })\n        }\n\n        const removeMiddlewear = middlewear => {\n            const index = middlewears.indexOf(middlewear)\n            return middlewears.splice(index, 1)\n        }\n\n        const unsubscribe = callback => {\n            const index = handlers.indexOf(callback)\n            return handlers.splice(index, 1)\n        }\n\n        const subscribe = (callbacks, preload, enhancers = []) => {\n            callbacks.map(callbak => {\n                handlers.push(callbak)\n                if (preload !== false) {\n                    callbak.call(this, store.state)\n                }\n            })\n\n            enhancers.map(enhancer => {\n                middlewears.push(enhancer)\n            })\n\n            return {handlers, middlewears}\n        }\n        this._stores.push({store, handler, middlewear})\n        return { subscribe, unsubscribe, removeMiddlewear }\n    }\n\n    public unregister(store: IStore): void {\n        if (!store) {\n            throw new Error(`Should provide store.`)\n        }\n\n        if (this._stores.length === 0) {\n            return\n        }\n\n        const index = this._stores.indexOf(store)\n        this._stores.splice(index, 1)\n    }\n\n    public dispatch(action: IAction): void {\n        if (!action) {\n            throw new Error(`Should provide action.`)\n        }\n\n        if (this._stores.length === 0) {\n            return\n        }\n\n        this._stores.map(item => {\n            const store = item.store\n            const handler = item.handler\n            const middlewear = item.middlewear\n            store.reduce.call(store, action, handler, middlewear)\n        })\n    }\n\n    public hasStore(): boolean {\n        return this._stores.length > 0\n    }\n}\n","import {IDispatcher, IBindDispatcherToStore, IStore} from '../types/index.d'\n\nexport function ActionCreator(dispatcher: IDispatcher) {\n    const createAction = (type: string) => {\n        if (!type) {\n            throw new Error(`Should provide action type property.`)\n        } else {\n            return (payload: any) => {\n                return dispatcher.dispatch({type, payload})\n            }\n        }\n    }\n\n    const createSubscriber = (store: IStore): IBindDispatcherToStore => {\n        if (!store) {\n            throw new Error(`Should provide store.`)\n        }\n        return dispatcher.register(store)\n    }\n\n    return { createAction, createSubscriber }\n}\n","import Store from './store'\nimport {IReducer, IStore} from '../types/index.d'\n\nexport function CreateStore<TState>(reducer: IReducer, initialState: TState): IStore {\n    return new Store(reducer, initialState)\n}\n","import Store from './store'\nimport Dispatcher from './dispatcher'\nimport {ActionCreator} from './actioncreator'\nimport {CreateStore} from './createstore'\n\nconst miniflux = {\n    Store,\n    Dispatcher,\n    ActionCreator,\n    CreateStore,\n}\n\nexport default miniflux\n"],"names":[],"mappings":"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"}