{"version":3,"file":"bundle.js","sources":["../src/store.ts","../src/dispatcher.ts","../src/actioncreator.ts","../src/createstore.ts","../src/index.ts"],"sourcesContent":["import {IAction, IHandler, IMiddlewear, IReducer, IStore} from '../types/index.d'\n\nexport default class Store<TState> implements IStore {\n    private _state: TState\n    private _reducer: IReducer\n\n    constructor(reducer, initialState: TState) {\n        this.reducer = reducer\n        this.state = initialState\n    }\n\n    set state(state: TState) {\n        this._state = state\n    }\n\n    get state(): TState {\n        return this._state\n    }\n\n    set reducer(reducer: IReducer) {\n        if (!reducer) {\n            throw Error(`Reducer is nessesary.`)\n        }\n        this._reducer = reducer\n    }\n\n    get reducer(): IReducer {\n        return this._reducer\n    }\n\n    public reduce(action: IAction, handler?: IHandler, middlewear?: IMiddlewear): TState {\n        if (!this._reducer) {\n            throw Error(`store should has reducer`)\n        }\n\n        let state = this.state\n\n        if (middlewear) {\n            middlewear.call(null, state, action)\n        }\n\n        state = this.reducer.call(null, state, action)\n\n        if (handler) {\n            handler.call(null, state)\n        }\n\n        this.state = state\n        return state\n    }\n}\n","import {IAction, IHandler, IMiddlewear, IStore, IDispatcher, IBindDispatcherToStore} from '../types/index.d'\n\nexport default class Dispatcher implements IDispatcher {\n    private _stores: any[] = []\n\n    public register(store: IStore): IBindDispatcherToStore {\n        if (!store) {\n            throw new Error(`Should provide store.`)\n        }\n        const handlers: IHandler[] = []\n        const middlewears: IMiddlewear[] = []\n\n        const handler = (data) => {\n            if (handlers.length <= 0) {\n                return\n            }\n\n            handlers.map(handler => {\n                handler.call(this, data)\n            })\n        }\n\n        const middlewear = (data, action) => {\n            if (middlewears.length <= 0) {\n                return\n            }\n            middlewears.map(enhancer => {\n                enhancer.call(this, data, action)\n            })\n        }\n\n        const removeMiddlewear = middlewear => {\n            const index = middlewears.indexOf(middlewear)\n            return middlewears.splice(index, 1)\n        }\n\n        const unsubscribe = callback => {\n            const index = handlers.indexOf(callback)\n            return handlers.splice(index, 1)\n        }\n\n        const subscribe = (callbacks, preload, enhancers = []) => {\n            callbacks.map(callbak => {\n                handlers.push(callbak)\n                if (preload !== false) {\n                    callbak.call(this, store.state)\n                }\n            })\n\n            enhancers.map(enhancer => {\n                middlewears.push(enhancer)\n            })\n\n            return {handlers, middlewears}\n        }\n        this._stores.push({store, handler, middlewear})\n        return { subscribe, unsubscribe, removeMiddlewear }\n    }\n\n    public unregister(store: IStore): void {\n        if (!store) {\n            throw new Error(`Should provide store.`)\n        }\n\n        if (this._stores.length === 0) {\n            return\n        }\n\n        const index = this._stores.indexOf(store)\n        this._stores.splice(index, 1)\n    }\n\n    public dispatch(action: IAction): void {\n        if (!action) {\n            throw new Error(`Should provide action.`)\n        }\n\n        if (this._stores.length === 0) {\n            return\n        }\n\n        this._stores.map(item => {\n            const store = item.store\n            const handler = item.handler\n            const middlewear = item.middlewear\n            store.reduce.call(store, action, handler, middlewear)\n        })\n    }\n\n    public hasStore(): boolean {\n        return this._stores.length > 0\n    }\n}\n","import {IDispatcher, IBindDispatcherToStore, IStore} from '../types/index.d'\n\nexport function ActionCreator(dispatcher: IDispatcher) {\n    const createAction = (type: string) => {\n        if (!type) {\n            throw new Error(`Should provide action type property.`)\n        } else {\n            return (payload: any) => {\n                return dispatcher.dispatch({type, payload})\n            }\n        }\n    }\n\n    const createSubscriber = (store: IStore): IBindDispatcherToStore => {\n        if (!store) {\n            throw new Error(`Should provide store.`)\n        }\n        return dispatcher.register(store)\n    }\n\n    return { createAction, createSubscriber }\n}\n","import Store from './store'\nimport {IReducer, IStore} from '../types/index.d'\n\nexport function CreateStore<TState>(reducer: IReducer, initialState: TState): IStore {\n    return new Store(reducer, initialState)\n}\n","import Store from './store'\nimport Dispatcher from './dispatcher'\nimport {ActionCreator} from './actioncreator'\nimport {CreateStore} from './createstore'\n\nconst miniflux = {\n    Store,\n    Dispatcher,\n    ActionCreator,\n    CreateStore,\n}\n\nexport default miniflux\n"],"names":[],"mappings":"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"}